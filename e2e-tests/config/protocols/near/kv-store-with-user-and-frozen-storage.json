{
  "steps": [
    {
      "applicationInstall": {
        "application": {
          "localFile": "./apps/kv-store-with-user-and-frozen-storage/res/kv_store_with_user_and_frozen_storage.wasm"
        },
        "target": "allMembers"
      }
    },
    {
      "contextCreate": null
    },
    {
      "contextCreateAlias": {
        "aliasName": "my_context_kv_store_with_user_and_frozen_storage"
      }
    },
    {
      "wait": {
        "for": "broadcast",
        "durationMs": 500,
        "description": [
          "Wait for broadcast propagation (~6ms measured, 200ms for safety)"
        ]
      }
    },
    {
      "contextInviteJoin": null
    },
    {
      "wait": {
        "for": "consensus",
        "durationMs": 2000,
        "description": [
          "Wait for invitations to complete, mesh formation + sync (~6ms measured, 1000ms for mesh + cascade)"
        ]
      }
    },
    {
      "call": {
        "methodName": "set_user_simple",
        "argsJson": {
          "value": "SomeSimpleUserString"
        },
        "expectedResultJson": null,
        "target": "inviter"
      }
    },
    {
      "call": {
        "methodName": "get_user_simple",
        "argsJson": {
        },
        "expectedResultJson": "SomeSimpleUserString",
        "target": "inviter"
      }
    },
    {
      "call": {
        "methodName": "set_user_nested",
        "argsJson": {
		  "key": "UserNestedKey1",
          "value": "UserNestedValue1"
        },
        "expectedResultJson": null,
        "target": "inviter"
      }
    },
    {
      "call": {
        "methodName": "get_user_nested",
        "argsJson": {
			"key": "UserNestedKey1"
        },
        "expectedResultJson": "UserNestedValue1",
        "target": "inviter"
      }
    },
    {
      "call": {
        "methodName": "add_frozen",
        "argsJson": {
          "value": "SomeFrozenString"
        },
        "expectedResultJson": "c8acd3c44a96324de12a82dd674aa1c93a635fbb76a852ae14363f9b1971beb1",
        "target": "inviter"
      }
    },
    {
      "call": {
        "methodName": "get_frozen",
        "argsJson": {
			"hash_hex": "c8acd3c44a96324de12a82dd674aa1c93a635fbb76a852ae14363f9b1971beb1"
        },
        "expectedResultJson": "SomeFrozenString",
        "target": "inviter"
      }
    },
    {
      "wait": {
        "for": "consensus",
        "durationMs": 2000,
        "description": [
          "Wait for mesh formation + sync (~6ms measured, 1000ms for mesh + cascade)"
        ]
      }
    },
    {
      "call": {
        "methodName": "get_frozen",
        "argsJson": {
			"hash_hex": "c8acd3c44a96324de12a82dd674aa1c93a635fbb76a852ae14363f9b1971beb1"
        },
        "expectedResultJson": "SomeFrozenString",
        "target": "allMembers",
        "retries": 5,
        "intervalMs": 1000,
        "description": [
          "Verify all nodes have frozen value 'SomeFrozenString'.",
          "Increased retries for CI: 30 attempts with 3s intervals = up to 90s.",
          "Smart peer selection should ensure nodes bootstrap from inviter."
        ]
      }
    },
    {
      "wait": {
        "for": "broadcast",
        "durationMs": 500,
        "description": [
          "Wait for broadcast propagation (~6ms measured, 200ms for safety)"
        ]
      }
    }
  ]
}
