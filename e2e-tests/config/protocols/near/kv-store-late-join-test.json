{
  "steps": [
    {
      "applicationInstall": {
        "application": {
          "localFile": "./apps/kv-store/res/kv_store.wasm"
        },
        "target": "allMembers"
      }
    },
    {
      "contextCreate": null
    },
    {
      "contextCreateAlias": {
        "aliasName": "my_context_late_join"
      }
    },
    {
      "wait": {
        "for": "broadcast",
        "durationMs": 500,
        "description": [
          "Wait for context creation to propagate"
        ]
      }
    },
    {
      "call": {
        "methodName": "set",
        "argsJson": {
          "key": "key0",
          "value": "value0"
        },
        "target": "inviter",
        "description": "Inviter sets key0"
      }
    },
    {
      "call": {
        "methodName": "set",
        "argsJson": {
          "key": "key1",
          "value": "value1"
        },
        "target": "inviter",
        "description": "Inviter sets key1"
      }
    },
    {
      "call": {
        "methodName": "set",
        "argsJson": {
          "key": "key2",
          "value": "value2"
        },
        "target": "inviter",
        "description": "Inviter sets key2"
      }
    },
    {
      "call": {
        "methodName": "set",
        "argsJson": {
          "key": "key3",
          "value": "value3"
        },
        "target": "inviter",
        "description": "Inviter sets key3"
      }
    },
    {
      "call": {
        "methodName": "set",
        "argsJson": {
          "key": "key4",
          "value": "value4"
        },
        "target": "inviter",
        "description": "Inviter sets key4"
      }
    },
    {
      "call": {
        "methodName": "set",
        "argsJson": {
          "key": "key5",
          "value": "value5"
        },
        "target": "inviter",
        "description": "Inviter sets key5"
      }
    },
    {
      "call": {
        "methodName": "set",
        "argsJson": {
          "key": "key6",
          "value": "value6"
        },
        "target": "inviter",
        "description": "Inviter sets key6"
      }
    },
    {
      "call": {
        "methodName": "set",
        "argsJson": {
          "key": "key7",
          "value": "value7"
        },
        "target": "inviter",
        "description": "Inviter sets key7"
      }
    },
    {
      "call": {
        "methodName": "set",
        "argsJson": {
          "key": "key8",
          "value": "value8"
        },
        "target": "inviter",
        "description": "Inviter sets key8"
      }
    },
    {
      "call": {
        "methodName": "set",
        "argsJson": {
          "key": "key9",
          "value": "value9"
        },
        "target": "inviter",
        "description": "Inviter sets key9"
      }
    },
    {
      "wait": {
        "for": "broadcast",
        "durationMs": 500,
        "description": [
          "Wait for all 10 set operations to be persisted"
        ]
      }
    },
    {
      "call": {
        "methodName": "len",
        "argsJson": {},
        "expectedResultJson": 10,
        "target": "inviter",
        "description": "Inviter should have all 10 keys before invitee joins"
      }
    },
    {
      "contextInviteJoin": null
    },
    {
      "wait": {
        "durationMs": 2000,
        "for": "consensus",
        "description": [
          "Wait for invitee to sync full state history via DAG catchup"
        ]
      }
    },
    {
      "call": {
        "methodName": "get",
        "argsJson": {
          "key": "key0"
        },
        "expectedResultJson": "value0",
        "target": "allMembers",
        "description": "Both nodes should have key0",
        "retryCount": 10,
        "retryDelayMs": 1000
      }
    },
    {
      "call": {
        "methodName": "get",
        "argsJson": {
          "key": "key1"
        },
        "expectedResultJson": "value1",
        "target": "allMembers",
        "description": "Both nodes should have key1"
      }
    },
    {
      "call": {
        "methodName": "get",
        "argsJson": {
          "key": "key2"
        },
        "expectedResultJson": "value2",
        "target": "allMembers",
        "description": "Both nodes should have key2"
      }
    },
    {
      "call": {
        "methodName": "get",
        "argsJson": {
          "key": "key3"
        },
        "expectedResultJson": "value3",
        "target": "allMembers",
        "description": "Both nodes should have key3"
      }
    },
    {
      "call": {
        "methodName": "get",
        "argsJson": {
          "key": "key4"
        },
        "expectedResultJson": "value4",
        "target": "allMembers",
        "description": "Both nodes should have key4"
      }
    },
    {
      "call": {
        "methodName": "get",
        "argsJson": {
          "key": "key5"
        },
        "expectedResultJson": "value5",
        "target": "allMembers",
        "description": "Both nodes should have key5"
      }
    },
    {
      "call": {
        "methodName": "get",
        "argsJson": {
          "key": "key6"
        },
        "expectedResultJson": "value6",
        "target": "allMembers",
        "description": "Both nodes should have key6"
      }
    },
    {
      "call": {
        "methodName": "get",
        "argsJson": {
          "key": "key7"
        },
        "expectedResultJson": "value7",
        "target": "allMembers",
        "description": "Both nodes should have key7"
      }
    },
    {
      "call": {
        "methodName": "get",
        "argsJson": {
          "key": "key8"
        },
        "expectedResultJson": "value8",
        "target": "allMembers",
        "description": "Both nodes should have key8"
      }
    },
    {
      "call": {
        "methodName": "get",
        "argsJson": {
          "key": "key9"
        },
        "expectedResultJson": "value9",
        "target": "allMembers",
        "description": "Both nodes should have key9"
      }
    },
    {
      "call": {
        "methodName": "len",
        "argsJson": {},
        "expectedResultJson": 10,
        "target": "allMembers",
        "description": "Both nodes should have all 10 keys after sync"
      }
    }
  ]
}

